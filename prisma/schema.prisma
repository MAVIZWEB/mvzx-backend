 generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          Int       @id @default(autoincrement())
  email       String    @unique
  pin         String
  wallet      String    @unique
  balance     Float     @default(0)
  referredBy  Int?
  purchases   Purchase[]
  matrices    Matrix[]
  withdrawals Withdrawal[]
}

model Purchase {
  id       Int     @id @default(autoincrement())
  userId   Int
  stage    Int
  amount   Float
  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id])
}

model Matrix {
  id        Int      @id @default(autoincrement())
  userId    Int
  stage     Int
  position  Int
  earnings  Float    @default(0)
  parentId  Int?
  children  Int      @default(0)

  user   User    @relation(fields: [userId], references: [id])
  parent Matrix? @relation("MatrixChildren", fields: [parentId], references: [id])
  childrenRel Matrix[] @relation("MatrixChildren")
}

model Withdrawal {
  id       Int     @id @default(autoincrement())
  userId   Int
  amount   Float
  method   String
  status   String
  details  String?
  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id])
}

model CompanyFund {
  id       Int     @id @default(autoincrement())
  userId   Int
  stage    Int
  amount   Float
  type     String
  createdAt DateTime @default(now())
}
